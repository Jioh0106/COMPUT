<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COMPUT.</title>

    <!-- TOAST Grid CSS -->
    <link rel="stylesheet" href="https://uicdn.toast.com/grid/latest/tui-grid.css" />
    
    <!-- Bootstrap & Custom CSS -->
    <link rel="stylesheet" th:href="@{/assets/css/bootstrap.css}">
    <link rel="stylesheet" th:href="@{/assets/vendors/iconly/bold.css}">
    <link rel="stylesheet" th:href="@{/assets/vendors/perfect-scrollbar/perfect-scrollbar.css}">
    <link rel="stylesheet" th:href="@{/assets/vendors/bootstrap-icons/bootstrap-icons.css}">
    <link rel="stylesheet" th:href="@{/assets/css/app.css}">
    
    <!-- CSRF 토큰 -->
    <meta id="_csrf" name="_csrf" th:content="${_csrf.token}" />
    <meta id="_csrf_header" name="_csrf_header" th:content="${_csrf.headerName}" />

    <style>
        .grid-height {
            height: 300px;
        }
        .qc-form {
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-bottom: 20px;
        }
    </style>
</head>

<body>
    <div id="app">
        <div th:replace="~{fragments/sidebar :: sidebar}"></div>
        <div id="main">
            <div class="display-flex">
                <h3>품질 검사</h3>
            </div>

            <div class="card">
                <div class="card-body">
                    <section class="section">
                        <!-- 검색 조건 -->
                        <div class="row mb-4">
                            <div class="col-md-4">
                                <label for="processNo" class="form-label">공정구분</label>
                                <select id="processNo" class="form-control" onchange="updateGrid()">
                                    <option value="">전체</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label for="lotNo" class="form-label">LOT 번호</label>
                                <input type="text" id="lotNo" class="form-control" 
                                       onkeyup="updateGrid()">
                            </div>
                        </div>

                        <!-- 검사 대기 목록 그리드 -->
                        <div class="grid-height" id="waitListGrid"></div>

                        <!-- 품질 검사 입력 폼 -->
                        <div class="qc-form mt-4" id="qcForm" style="display: none;">
                            <h5>품질 검사 등록</h5>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">LOT 번호</label>
                                        <input type="text" id="formLotNo" class="form-control" readonly>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">검사항목</label>
                                        <input type="text" id="formQcName" class="form-control" readonly>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="form-label">측정값</label>
                                        <input type="number" id="formMeasureValue" class="form-control">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="form-label">검사자</label>
                                        <input type="text" id="formInspector" class="form-control">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="form-label">판정</label>
                                        <select id="formJudgement" class="form-control">
                                            <option value="OK">OK</option>
                                            <option value="NG">NG</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-12">
                                    <div class="mb-3">
                                        <label class="form-label">비고</label>
                                        <textarea id="formNote" class="form-control" rows="3"></textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="d-flex justify-content-end">
                                <button type="button" class="btn btn-primary me-2" onclick="startInspection()">
                                    검사 시작
                                </button>
                                <button type="button" class="btn btn-success" onclick="completeInspection()">
                                    검사 완료
                                </button>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </div>

    <script th:src="@{/js/jquery-3.7.1.js}"></script>
    <script th:src="@{/assets/js/bootstrap.bundle.min.js}"></script>
    <script th:src="@{/assets/vendors/perfect-scrollbar/perfect-scrollbar.min.js}"></script>
    <script th:src="@{/assets/js/main.js}"></script>
    
    <script src="https://uicdn.toast.com/grid/latest/tui-grid.js"></script>
    <script th:src="@{/js/process/quality_check.js}"></script>
</body>
</html>