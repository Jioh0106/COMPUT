<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COMPUT.</title>

    <!-- CSS 라이브러리 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://uicdn.toast.com/grid/latest/tui-grid.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.15/themes/default/style.min.css">

	<link rel="stylesheet" th:href="@{/assets/css/bootstrap.css}">
    <link rel="stylesheet" th:href="@{/assets/vendors/iconly/bold.css}">
    <link rel="stylesheet" th:href="@{/assets/vendors/perfect-scrollbar/perfect-scrollbar.css}">
    <link rel="stylesheet" th:href="@{/assets/vendors/bootstrap-icons/bootstrap-icons.css}">
    <link rel="stylesheet" th:href="@{/assets/css/app.css}">
	<link rel="icon" href="images/favicon.png" type="images/png">
    <!-- 커스텀 CSS -->
    
    <meta id="_csrf" name="_csrf" th:content="${_csrf.token}" />
    <meta id="_csrf_header" name="_csrf_header" th:content="${_csrf.headerName}" />
    
    
    <style>
        body { background-color: #f4f6f9; }
        .lot-tracking-container {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .lot-tree-container {
            max-height: 500px;
            overflow-y: auto;
        }
        .lot-details-card {
            border-left: 4px solid #007bff;
        }
        .status-badge {
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
        }
        .status-created { background-color: #e9ecef; color: #6c757d; }
        .status-progress { background-color: #d1ecf1; color: #0c5460; }
        .status-complete { background-color: #d4edda; color: #155724; }
    #lotTreeView {
        background-color: #fff;
        border: 1px solid #ddd;
        padding: 10px;
        font-size: 14px;
    }
    .jstree-default .jstree-anchor {
        height: 24px;
        line-height: 24px;
    }
    .jstree-default .jstree-icon {
        color: #666;
    }
    /* 선택된 노드 스타일 */
    .jstree-default .jstree-clicked {
        background-color: #e3f2fd;
        border-radius: 2px;
        box-shadow: none;
    }
    /* 상세 정보 영역 스타일 */
    .lot-details-section {
        background: #f8f9fa;
        padding: 15px;
        margin-bottom: 15px;
        border-radius: 4px;
    }
    .lot-info-item {
        margin-bottom: 8px;
    }
    .lot-info-label {
        font-weight: bold;
        color: #495057;
    }
    </style>
</head>
<body>
	<div id="app">
        <div th:replace="~{fragments/sidebar :: sidebar}"></div>
        <div id="main">
            <div class="display-flex">
                <h3>LOT 추적</h3>
            </div>
		    <div class="container-fluid py-4">
		        <div class="row">
		            <div class="col-12">
		                <div class="lot-tracking-container p-4">
		                    <div class="row">
		                        <!-- 검색 영역 -->
		                        <div class="col-12 mb-4">
		                            <div class="input-group">
		                                <input type="text" id="lotSearchInput" class="form-control" placeholder="LOT 번호 또는 제품명 검색">
		                                <select id="productSelect" class="form-select" style="max-width: 200px;">
		                                    <option value="0">전체 제품</option>
		                                </select>
		                                <button id="searchButton" class="btn btn-primary">
		                                    <i class="bi bi-search"></i> 검색
		                                </button>
		                            </div>
		                        </div>
		
		                        <!-- LOT 트리 및 상세 정보 -->
		                        <div class="col-4">
		                            <div class="card lot-tree-container">
		                                <div class="card-header">
		                                    <h6 class="mb-0">LOT 계층 구조</h6>
		                                </div>
		                                <div class="card-body p-0">
		                                    <div id="lotTreeView"></div>
		                                </div>
		                            </div>
		                        </div>
		
		                        <div class="col-8">
		                            <div id="lotDetailsView" class="card lot-details-card">
		                                <!-- 상세 정보 표시 영역 -->
		                                <div class="card-header">
		                                    <h6 class="mb-0">LOT 상세 정보</h6>
		                                </div>
		                                <div class="card-body">
		                                    <div id="lotDetailsContent">
		                                        LOT를 선택해주세요.
		                                    </div>
		                                </div>
		                            </div>
		
		                            <div class="card mt-3">
		                                <div class="card-header">
		                                    <h6 class="mb-0">공정 이력</h6>
		                                </div>
		                                <div class="card-body">
		                                    <div id="processHistoryGrid"></div>
		                                </div>
		                            </div>
		
		                            <div class="card mt-3">
		                                <div class="card-header">
		                                    <h6 class="mb-0">품질 검사 이력</h6>
		                                </div>
		                                <div class="card-body">
		                                    <div id="qcHistoryGrid"></div>
		                                </div>
		                            </div>
		                        </div>
		                    </div>
		                </div>
		            </div>
		        </div>
		    </div>
		</div>
</div>
    <!-- JavaScript 라이브러리 -->
    <script th:src="@{/js/jquery-3.7.1.js}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.1/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.15/jstree.min.js"></script>
    <script src="https://uicdn.toast.com/grid/latest/tui-grid.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"></script>
	<script th:src="@{/assets/js/bootstrap.bundle.min.js}"></script>
    <script th:src="@{/assets/vendors/perfect-scrollbar/perfect-scrollbar.min.js}"></script>
    <script th:src="@{/assets/js/main.js}"></script>

    <!-- 애플리케이션 스크립트 -->
    <script th:src="@{/js/lot/lot_tracking.js}"></script>
</body>
</html>